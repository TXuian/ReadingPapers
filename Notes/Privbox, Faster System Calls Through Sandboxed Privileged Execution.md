## Privbox: Faster System Calls Through Sandboxed Privileged Execution(TODO)

### Design
> Principle:
> - Privbox提供了标准同步、类似函数的系统调用，但调用成本更低。
> 	- 不需要重新架构设计；
> - 将代码运行在沙盒中，以使其具有与加载它的进程相同的访问权限。


- 沙盒技术：（1）沙盒内不可访问沙盒外的内存；（2）不可执行非特权指令
	- 编译时插装（在编译时插入额外代码）
		- 间接*加载/存储（Indirect load/store）*指令（其中操作数仅在运行时已知）通过引入“清理”内存操作数的指令进行插装，确保其不指向内核内存；
		- 对于x86-64上的Linux，我们利用清除*虚拟地址的最高有效位*保证创建用户地址或非规范化的非法地址，其访问将生成异常；（沙盒无法访问*有高位的的内存空间*）；
		- *间接控制流指令*，例如调用、跳转和返回也进行插装，以确保privboxed代码不会分支到任意内核地址；（控制流插装确保*控制流指令*只能分支到*在加载代码时验证的地址*）

	- 虚拟内存限制（通过*页表*）
		- Privbox的半特权执行安装的自定义分页表将privboxed代码区域之外的用户空间地址映射为非可执行（内核的地址空间被映射为可执行）；
